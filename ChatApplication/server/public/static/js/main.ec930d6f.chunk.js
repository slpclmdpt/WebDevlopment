(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,a){},16:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(8),i=a.n(r),c=(a(15),a(2)),u=a(3),o=a(6),l=a(4),m=a(5),d=a(1),h=(a(16),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).state={disabled:!0,input:""},a.handleInput=a.handleInput.bind(Object(d.a)(Object(d.a)(a))),a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"handleInput",value:function(e){e.target.value?this.setState({disabled:!1,input:e.target.value}):this.setState({disabled:!0})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"login"},s.a.createElement("input",{onChange:this.handleInput,value:this.state.input,name:"username",placeholder:"Enter Username"}),s.a.createElement("button",{disabled:this.state.disabled,onClick:function(t){return e.props.loginUser(e.state.input)}},"Login"))}}]),t}(s.a.Component)),p=function(e){var t=e.users;return s.a.createElement("ul",{className:"users"},Object.keys(t).map(function(e){return s.a.createElement("li",{className:"user",key:e},e)}))},f=function(e){return e.messages.map(function(e){return s.a.createElement("li",{key:"".concat(e.sender,",").concat(e.text)},s.a.createElement("div",{className:"message"},s.a.createElement("div",{className:"meta-info"},s.a.createElement("div",{className:"sender-info"},s.a.createElement("span",{className:"username"},e.sender)),s.a.createElement("div",{className:"message-info"},s.a.createElement("span",{className:"timestamp"},e.timestamp))),s.a.createElement("p",{className:"message-text"},e.text)))})},g=function(e){var t=e.messages;return s.a.createElement("ul",{className:"messages"},s.a.createElement(f,{messages:t}))},b=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).state={disabled:!0,input:""},a.handleInput=a.handleInput.bind(Object(d.a)(Object(d.a)(a))),a.clearInput=a.clearInput.bind(Object(d.a)(Object(d.a)(a))),a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"handleInput",value:function(e){e.target.value?this.setState({disabled:!1,input:e.target.value}):this.setState({disabled:!0})}},{key:"clearInput",value:function(){this.setState={input:""}}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"outgoing"},s.a.createElement("input",{className:"to-send",onChange:this.handleInput,value:this.state.input,name:"text",placeholder:"Enter message to send"}),s.a.createElement("button",{disabled:this.state.disabled,onClick:function(t){e.props.addMessage(e.state.input),e.clearInput()}},"Send"))}}]),t}(s.a.Component),v=function(){return fetch("/messages").catch(function(e){return Promise.reject({error:"Network error, try again later.",err:e})}).then(function(e){return e.ok?e.json():Promise.reject({error:"Data fetch failed, try again later.",err:e.statusText})})},j=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).state={users:e.users,messages:[],username:e.username},a.addMessage=a.addMessage.bind(Object(d.a)(Object(d.a)(a))),a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this;v().then(function(t){e.setState({users:t.users,messages:t.messages})})}},{key:"componentDidMount",value:function(){var e=this;setInterval(function(){v().then(function(t){e.setState({users:t.users,messages:t.messages})})},5e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId)}},{key:"addMessage",value:function(e){var t=this;e&&function(e,t){return fetch("/messages",{method:"PUT",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({message:t,username:e})}).catch(function(e){return Promise.reject({error:"Network error, try again later.",err:e})}).then(function(e){return e.ok?e.json():Promise.reject({error:"Message sent failed, try again later.",err:e.statusText})})}(this.state.username,e).then(function(e){t.setState({users:e.users,messages:e.messages})})}},{key:"render",value:function(){return s.a.createElement("div",{className:"chat-app"},s.a.createElement("div",{className:"display-panel"},s.a.createElement(p,{users:this.state.users}),s.a.createElement(g,{messages:this.state.messages})),s.a.createElement(b,{addMessage:this.addMessage}))}}]),t}(s.a.Component),O=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(o.a)(this,Object(l.a)(t).call(this))).state={users:{},username:""},e.loginUser=e.loginUser.bind(Object(d.a)(Object(d.a)(e))),e}return Object(m.a)(t,e),Object(u.a)(t,[{key:"loginUser",value:function(e){var t=this;(function(e){return fetch("/login",{method:"PUT",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({name:e})}).catch(function(e){return Promise.reject({error:"Network error, try again later.",err:e})}).then(function(e){return e.ok?e.json():Promise.reject({error:"Login failed, try again later.",err:e.statusText})})})(e).then(function(e){t.setState({username:e.username,users:e.users})})}},{key:"render",value:function(){return this.state.username?s.a.createElement(j,{users:this.state.users,username:this.state.username}):s.a.createElement(h,{loginUser:this.loginUser})}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},9:function(e,t,a){e.exports=a(17)}},[[9,1,2]]]);
//# sourceMappingURL=main.ec930d6f.chunk.js.map